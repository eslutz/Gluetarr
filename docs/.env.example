# ==============================================================================
# Forwardarr Configuration
# ==============================================================================
# This file contains all available configuration options for Forwardarr.
# Copy this file to `.env` and customize the values for your environment.
#
# For a quick reference, see the Configuration section in README.md
# ==============================================================================

# ------------------------------------------------------------------------------
# Gluetun Integration
# ------------------------------------------------------------------------------
# Path to the port file where Gluetun writes the forwarded port number.
# This file is monitored for changes using fsnotify.
#
# Default: /tmp/gluetun/forwarded_port
# Example (Docker volume): /tmp/gluetun/forwarded_port
GLUETUN_PORT_FILE=/tmp/gluetun/forwarded_port

# ------------------------------------------------------------------------------
# Torrent Client Connection
# ------------------------------------------------------------------------------
# Connection details for qBittorrent WebUI API.
# Forwardarr uses these credentials to authenticate and update the listening port.

# qBittorrent WebUI address (include protocol and port)
# Default: http://localhost:8080
# Example: http://qbittorrent:8080
TORRENT_CLIENT_URL=http://localhost:8080

# qBittorrent WebUI username
# Default: admin
TORRENT_CLIENT_USER=admin

# qBittorrent WebUI password
# Default: adminadmin
# ⚠️  IMPORTANT: Change this to match your qBittorrent password
TORRENT_CLIENT_PASSWORD=adminadmin

# ------------------------------------------------------------------------------
# Startup Retry Behavior
# ------------------------------------------------------------------------------
# Forwardarr will retry connecting to qBittorrent on startup to handle cases
# where dependencies (like Gluetun/qBittorrent) are not yet ready.
#
# Base delay between connection attempts (in seconds). Forwardarr uses
# exponential backoff (base, 2x, 4x...) until the startup timeout is reached,
# and derives the maximum attempts from the timeout and base delay.
# Default: 5
STARTUP_RETRY_DELAY=5

# Overall timeout before failing startup (in seconds). This should align with
# your container/orchestrator health check start period.
# Default: 120
STARTUP_TIMEOUT=120

# ------------------------------------------------------------------------------
# Sync Settings
# ------------------------------------------------------------------------------
# How often to check for port changes even if no file system event is detected.
# This provides a fallback mechanism in case file system events are missed.
#
# Set to 0 to disable periodic sync and rely only on file system events.
# Value is in seconds.
#
# Default: 300 (5 minutes)
# Recommended: 300-600 for most setups, 0 if you trust fsnotify events
SYNC_INTERVAL=300

# ------------------------------------------------------------------------------
# Server Settings
# ------------------------------------------------------------------------------
# HTTP server configuration for health checks, readiness probes, and metrics.

# Port for the HTTP server (health, readiness, status, metrics endpoints)
# Default: 9090
# Endpoints: /health, /ready, /status, /metrics
METRICS_PORT=9090

# Logging level controls verbosity of application logs
# Options: debug, info, warn, error
# Default: info
# 
# debug - Verbose logging including port sync operations
# info  - General application events (startup, port changes)
# warn  - Warnings and non-critical errors
# error - Only critical errors
LOG_LEVEL=info

# ------------------------------------------------------------------------------
# Webhook Notifications (Optional)
# ------------------------------------------------------------------------------
# Configure HTTP POST webhooks to receive notifications when events occur.
# Leave WEBHOOK_URL empty to disable webhook notifications entirely.

# Webhook endpoint URL
# Leave empty to disable webhooks
# Default: (empty - webhooks disabled)
# Examples:
#   Generic webhook: http://your-server.com/webhook
#   Discord: https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_TOKEN
#   Slack: https://hooks.slack.com/services/YOUR/WEBHOOK/PATH
#   Gotify: https://gotify.example.com/message?token=YOUR_TOKEN
# WEBHOOK_URL=

# Webhook payload template format
# Options: json, discord, slack, gotify
# Default: json
#
# json    - Generic JSON payload (compatible with most services)
# discord - Discord-formatted payload with embeds
# slack   - Slack-formatted payload with blocks
# gotify  - Gotify-formatted push notification
# WEBHOOK_TEMPLATE=json

# Events that trigger webhook notifications (comma-separated list)
# Default: port_changed
# Currently supported events:
#   - port_changed: Triggered when the forwarded port is successfully updated
#
# Example: WEBHOOK_EVENTS=port_changed
# WEBHOOK_EVENTS=port_changed

# HTTP request timeout for webhook delivery (in seconds)
# Default: 10
# Recommended: 5-30 depending on webhook endpoint reliability
# WEBHOOK_TIMEOUT=10

# ==============================================================================
# Example Configurations
# ==============================================================================

# --- Example 1: Basic Setup with Docker Compose ---
# GLUETUN_PORT_FILE=/tmp/gluetun/forwarded_port
# TORRENT_CLIENT_URL=http://qbittorrent:8080
# TORRENT_CLIENT_USER=admin
# TORRENT_CLIENT_PASSWORD=your_secure_password
# SYNC_INTERVAL=300
# METRICS_PORT=9090
# LOG_LEVEL=info

# --- Example 2: With Discord Webhook Notifications ---
# GLUETUN_PORT_FILE=/tmp/gluetun/forwarded_port
# TORRENT_CLIENT_URL=http://qbittorrent:8080
# TORRENT_CLIENT_USER=admin
# TORRENT_CLIENT_PASSWORD=your_secure_password
# SYNC_INTERVAL=300
# METRICS_PORT=9090
# LOG_LEVEL=info
# WEBHOOK_URL=https://discord.com/api/webhooks/YOUR_ID/YOUR_TOKEN
# WEBHOOK_TEMPLATE=discord
# WEBHOOK_EVENTS=port_changed
# WEBHOOK_TIMEOUT=10

# --- Example 3: Debug Mode with Faster Sync ---
# GLUETUN_PORT_FILE=/tmp/gluetun/forwarded_port
# TORRENT_CLIENT_URL=http://localhost:8080
# TORRENT_CLIENT_USER=admin
# TORRENT_CLIENT_PASSWORD=adminadmin
# SYNC_INTERVAL=60
# METRICS_PORT=9090
# LOG_LEVEL=debug
